#!/bin/env bash

# Exit immediately on errors
set -e

# Get the directory of this script
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
ROOT="$(cd "$SCRIPT_DIR" && cd .. && pwd)"

# Check if a tag argument was provided
if [ -z "$1" ]; then
    echo "Error: Please provide a tag name as the first argument"
    echo "Usage: $0 <tag-name>"
    exit 1
fi

# Run build.sh relative to the script's location
"$SCRIPT_DIR/build"

# Use the first argument ($1) as the tag for the release
gh release create "$1" "$ROOT/build/photo_frames.tar.gz" "$ROOT/build/photo_frames.tar.gz.sha512" --repo jeppester/nextcloud-photo-frames
